---
layout: post
title:  "花了一个月时间折腾Hackintosh的历程"
date:   2020-10-02
categories: [Jekyll Paper]
tags: [Getting Start]
---
入职这边研发基本都是windows，连外接显示器都没的领，我自己只有一台老掉了牙的thinkpad t440p个人电脑，以21世纪20年代人的视角来看，这电脑也是性能掉渣，屏幕眼瞎的玩意，windows系统的烂处就在于，你干活确实需要他，但当你干完了一天的活之后，这个系统就非常的让人厌恶，你碰都不想碰。每天下班回家后，我也实在是不想打开电脑了，但是好在这台电脑的可玩性不亚于某宝上的x220系列，而我以前就了解到这种上古机器到今天也有大量的玩家在折腾。对于黑苹果系列我几乎没有什么了解，只是知道安装应该比Ubuntu难搞的多。

我在实验室期间装过了很多次的Linux系统了，Mint、Fedora、Ubuntu、deepin在服务器和个人机器上都装过，不过桌面版Ubuntu经常无响应的系统与软件界面、糟糕的软件生态还是最后劝退了我，好在Mac OS是Unix系统，也是比较适合程序员开发的系统，我又不想花钱买macbook，所以hackintosh就是最好的方案了。

开始也没做什么调研，然后就直接在youtube上找了个Catalina的黑苹果教程干了。总结一下，黑苹果就几个关键步骤，你能确保无误就基本OK。T440p是支持比较好的机型之一了.

安装准备： 建议多搞几个u盘比较好，其中一个u盘弄黑苹果镜像，另外的可以装Ghost或者恢复镜像，防止出意外。我的是单系统安装，直接抹盘

1. 下载镜像，一般是下载预配置了clover的镜像，这个在黑果小兵的博客里都有。看你是想玩哪个版本的了。一般是10.13.X、10.14.X、10.15.X，分别是High Sierra，Mojave和Catalina。建议选X=5或6的小版本，因为这种版本更成熟，比刚出来时候的版本问题少，比如10.15.6。现在Big Sur应该也出了。我一开始装的是Catalina。不过考虑到电脑只有i5的性能，应选Mojave或者High Sierra才对。开始也不知道怎么找镜像，直接拉了个官方的镜像，然后用transmac写了一晚上U盘都没见动静，后来换成了小兵的Clover镜像，不到10min就搞好了，因为这两种镜像不是一回事。真的折腾前还是要搞清楚该干嘛
   这里，下载镜像之后最好做一下镜像的md5比对，如果下载的镜像损坏，会导致后续无法安装。
2. 下载EFI文件，这个直接搜索机型就出来的，t440p在github上有人维护efi文件，直接下载下来。用transmac把镜像写进去后，就是把这efi文件用diskgenius之类的软件替换进去了，因为windows不认苹果镜像的格式，只能拿第三方软件去导。
3. 然后就是格式化你的系统盘了，这个我是用进Ghost系统后，用里面的DG格式化的，还要保留200M以上的esr空间。

这样一切就准备完成了，在BIOS进行好必要的设置之后，就可以开始准备安装系统

重启进入U盘，应该可以见到Mac OS的安装界面。首先是格盘，把系统盘格成APFS Apple FileSystem格式。然后就可以准备安装了。这里，可能会提示你mac os镜像损坏，其实这里不是镜像损坏，应该是一个证书的问题，你只需要进Terminal 设置当前日期，把日期跳到2015年就OK了。然后就是傻瓜式安装了，中间会重启好多次，但是确保你每次都是在Clover界面选择 Install XXX from 你的盘 就可以。

最后当进入mac os系统了，就可以把之前的efi文件 放进系统盘预留的esr空间里了，这样每次就可以不需要u盘引导系统了，直接开机就可以进去了。

看似简单，其实里面还是有很多坑要踩。要不难怪TB还要帮你远程装黑苹果的服务呢（要100多元，本来我装不上心态要崩也差点下单了）
9月份相当长的一段时间，我都是8点多回来研究到12点多，然后早上7点多弄到8点多上班，还是比较折腾的。其中一次就是，我安装Catalina第二次成功了。不过我嫌Catalina在笔记本上很卡，我就想装Mojave或者High Sierra，但是没想到却始终装不上。系统重启几次后，总会卡在“估算剩余时间（Estimating Time Remaining）”上。我百思不得其解，但我也没找到什么解决方法。卡在“估算剩余时间”，照理来说应该几分钟之内就足够了，但我等了一个多小时了，U盘都很烫了，但是却没有反应。后来github上维护t440p efi文件的人告诉我，安装的时候最好把电脑所有的外接设备都拆掉。我就什么也没有留，但还是会卡在“估算剩余时间”里。最后我突然意识到，我的电脑光驱位是有一块机械硬盘的，我在想是不是这个原因，于是拆了电脑拿出了光驱位硬盘。果然是这个原因，最终电脑也成功的装上了High Sierra 10.13.6，直到现在一切都运行正常。后来打了几个Kext补丁，一些常见的问题，比如耳机有白噪声，光驱位硬盘识别不出这些也很快修复了。因为自己的无线网卡不支持，所以我提前就买了一个usb网卡，pdd 10几块钱搞定。

现在运行的总体我非常满意。说说mac上一些我喜欢的东西：

①外接显示器设置非常方便；

②很喜欢弹出来弹出去的魔术动画特效；

③iterm2很不错，homebrew配置国内源也很方便，系统响应也快。你试试去Ubuntu的Setting里换源就知道我的意思了。

④字体和布局感觉好看好多。

⑤毕竟支持大多数Unix命令，所以开发起来还是很爽的，很多工具如awk，sed都自带，windows上就要装cygwin或者手动装GNU的工具包曲线救国了，还是很不方便

另外碰到的一些问题：


①有时候启动机器，会无法输出声音，无法调节音量，顶栏的喇叭显示是灰色的，这个是概率性的，不知道怎么搞，如果有知道的麻烦告诉我；

②本机显示器的色彩偏紫色，比如百度的蓝色图标会偏紫，外接的不会（这个在以前装Ubuntu的时候也遇到了，不知道怎么调，没找到解决方法。）

③因为是10.13.6，有些软件可能不支持，只支持Mojave以后的。不过这不是大问题。

④机器续航捉急，不过我都是接电源，所以这个不在乎

目前显示器外接的是MINI DP线，不玩游戏，上网写代码基本没什么问题

如果原版mac算10分，这台能有8分。

软件生态我也很满意，基本上需要的软件都有，例如qq、微信、浏览器、科X上网，ide和vscode，以及影音、文档之类的。mac系统和软件在界面上也做的很美观，字体和布局看着都比windows和Ubuntu舒服。而且mac 的iterm2 比cmd好用太多了。要说唯一不满意的地方就是，这笔记本屏幕太瞎眼了，768p能干的事情很少，还是准备买个显示器；另外访达实在是太难用。如果有同学的个人电脑想装Ubuntu写代码的话，我还是更建议你一步到位整一个黑苹果的，毕竟软件上还是更好用一些！再说了，现在的Ubuntu太难用了，我觉得16.04 LTS 应该是最好的一版Ubuntu了，20.04最近用了一段时间，无论是稳定性和新界面都很难说喜欢。感觉越来越花里胡哨的桌面端Linux就是一种邪路。

黑苹果装好后，就感觉基本上那样了，也没想法玩出什么花来，配置基本上是照着网上的教程来配置，毕竟折腾的机会越来越少了。

最后附两张10.13.6 High Sierra的截图 ![在这里插入图片描述](https://img-blog.csdnimg.cn/20201002231547706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4MzM5ODMy,size_16,color_FFFFFF,t_70#pic_center)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201002231723692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4MzM5ODMy,size_16,color_FFFFFF,t_70#pic_center)

- ***2020年12月13日更新**：
  已从苹果商店更新了 Mojave 10.14.6，，安装方式基本同上，装的时候拆掉所有usb外围设备（wifi、鼠标键盘、外置硬盘和光驱位硬盘）。安装过程非常顺利，耳机噪音重新打了补丁，目前一切正常！
  使用感觉与High Sierra相比，优化程度还是比较大的，更建议升级Mojave。应用的加载速度比较快，此外，输入法切换速度好了很多，HS一直都要卡一会，然后暗黑模式什么的就不说了，还是优化蛮不错的。
