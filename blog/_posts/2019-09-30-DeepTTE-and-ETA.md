---
title: When Will You Arrive? Estimating Travel Time Based on Deep Neural Networks 论文笔记
key: 20180701
tags: 论文阅读
---
## 总结

DeepTTE 
When Will You Arrive? Estimating Travel Time Based on Deep Neural Networks  论文笔记

AAAI2018, 微软


TTE/ETA相关的场景，可以用于出行、配送等场景。滴滴地图和美团百度等应该都有类似的业务。

论文其实是某天听部门组织的串讲的时候，大佬提到的，所以特别注意了一下，回去搜了看的。

美团的技术博客上也有一篇他们的解决方案，可以结合着看看

根据*一条已经规划好的路线，计算预估时间*.

轨迹数据：一般是采样的GPS信号，比如“时间戳-经纬度”的点集合。此外，还有类似driverid，天气id，weekID等附加的信息

During the training phase, we learn how to estimate the travel time of the given path and the corresponding external factors, based on the spatio-temporal patterns extracted from the historical trajectories as we defined in Definition. 1. During the test phase, given the path P, our goal is to estimate the travel time from the starting to the destination through P, with the corresponding external factors. We assume that the travel path P is specified by the user or generated by the route planing apps. During the test phase, to make the testing data consistent with the training data, we convert a path P to a sequence of location points with equal distance gaps. Each location is represented as a pair of longitude and latitude

训练阶段：
给定路线，其他附加信息  -> eta

测试阶段：
给定规划好的路线，估计eta


DeepTTE模型结构：
attribute component, spatio-temporal learning component, and multi-task learning component


#### 1、attr component: 
such as the start time, the day of week, the weather condition and also the driving habits….
we incorporate the attributes of the weather condition (rainy/sunny/windy etc.) , the driver ID, the time information (day of the week and timeslot of travel 2501 start2). We use weatherID, driverID, weekID and timeID to denote these attributes respectively…

Gal and Ghahramani 2016


16), the embedding method mainly has two advantages. First, since the vocabulary size of the categorical values can be very large (e.g., there are 20442 drivers in our dataset), the embedding method effectively reduces the input dimension and thus it is more computationally efficient. Furthermore, it has been shown that the categorical values with similar semantic meaning are usually embedded to the close locations (Gal and Ghahramani 2016). Thus, the embedding method helps find and share similar patterns among different trajectories .

此外还使用了行驶距离（连续特征）作为一个重要的特征

#### 2、Spatio-Temporal Component
时空特征，GeoConv。(他比CNN的优势在于哪？CNN同样可以获取空间特征，但是，在地理场景里，车子的转向、转弯是无法被CNN获取的。(Zhang et al. 2016)尝试把城市划分成网格，把每个gps点映射到某个网格中，但是不够精准。如果汽车转弯发生在同一个格子里，那么是无法获取转弯之类的信息的

为此，提出的GeoConv则可以挖掘出此类特征

首先，映射 loci = tanh(Wloc · [pi.lat ◦ pi.lng]) pi是一个gps点。即lat和lng concat在一起，输出16通道的feature 是 16*|Traj|。16是通道，每个通道表示其地理特征（为什么16？）
使用卷积神经网络，用滑动的一维串口做卷积，它第i维的输出是locconv i = σcnn(Wconv ∗ loci:i+k−1 + b)


 σcnn 是激活函数 b是偏置  k是kernel size (1-D CNN)

#### 3. Local Path 
the sub-sequence from point pi to point pi+k−1 as the i-th local path.  , loc conv i
使用c个卷积核，
此外，对于获取的特征图，还加入了一列特征，即第i个local path的长度。这一类特征输出，获取了local path的特征
=> loc f

#### recurrent层：
以上的思路，捕获了数据集中的空间特征
提取时间特征：输入是上面geoconv的输出 loc f，长度 |T| − k + 1；还有上面的attr 特征。
hi = σrnn(Wx · locf i + Wh · hi−1 + Wa · attr)
hi 就是隐藏态 式子里的 W* 均是网络里的可学习参数。σrnn 是激活函数
由于会出现梯度消失和梯度爆炸的问题，改用LSTM层

最终输出的时空特征  **{h1, h2,...,h|T|−k+1}**

#### 多任务学习：

之前的tte估计，一般是两种： individual和collective的。前者的估计方法不考虑local path之间的时空关系，会导致误差逐渐累积；而后者会出现数据稀疏的问题。订单的轨迹里只有少数几个GPS点的话，就不容易估计准确。

为此，论文想结合这两种方案学习。即训练的时候，保证local path和 全局的tte 都准确。 在预测的时候则只预测全局的tte。

local path 的tte预估

对于得到的时空序列特征 ST_feature = **{h1, h2,...,h|T|−k+1}** ，h_i 是指每一个local path的时空特征 使用两个全连接层输出一个标量r_i 即第i个local path的tte。

全局的tte 预估

对 不同的ST_feature,其长度是不同的。 取决于一维卷积的核大小和轨迹的长度。 为此这里可以使用了平均池化。**但是**,文章这里使用了注意力机制，




